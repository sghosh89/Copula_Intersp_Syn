--- 
title: "A new approach to interspecific synchrony and its causes in population ecology using ``copulas''"
author: "Shyamolina Ghosh, Lawrence W. Sheppard, Philip C. Reid, Daniel Reuman"
date: "`r format(Sys.time(), '%d %B, %Y')`"
geometry: "left=1 in,right=1 in,top=1 in,bottom=1 in"

output: 
  pdf_document:
    number_sections: no
    keep_tex: yes
    fig_caption: yes
    includes:
      in_header: head_MainText.sty
      
tables: True
link-citations: True
urlcolor : blue
indent : True

csl: TheAmericanNaturalist.csl
bibliography: REF_CIS.bib
---

```{r setup_MainText, echo=F}
library(rmarkdown)
knitr::opts_chunk$set(echo = TRUE, fig.pos = "H")
options(scipen = 1, digits = 5) #This option round all numbers appeared in the inline r code upto 5th digit
seed<-101
```

\noindent \emph{Affiliations:}

\noindent Ghosh: Department of Ecology and Evolutionary Biology and Kansas Biological Survey, University of Kansas, Lawrence, KS, 66045, USA

\noindent Sheppard: Department of Ecology and Evolutionary Biology and Kansas Biological Survey, University of Kansas, Lawrence, KS, 66045, USA

\noindent Reid: School of Biological & Marine Sciences, University of Plymouth, Drake Circus, Plymouth PL4 8AA, UK; Continuous Plankton Recorder Survey, The Marine Biological Association, The Laboratory, Citadel Hill, Plymouth PL1 2PB, UK

\noindent Reuman: Department of Ecology and Evolutionary Biology and Kansas Biological Survey, University of Kansas, Lawrence, KS, 66047, USA; Laboratory of Populations, Rockefeller University, 1230 York Ave, New York, NY, 10065, USA

<!--\noindent\makebox[\linewidth]{\rule{\columnwidth}{1pt}}
\scriptsize-->

\newpage

\noindent \textbf{ABSTRACT} 
<!--\small write abstract here-->
<!--200 words limit : J Am Nat, 350 words for J. animal eco.-->

A recent study [@Ghosh_copula] showed the potential uses of copula methods in examining
"spatial synchrony" between metapopulations. 
We used this copula concept to estimate synchronous and/ or compensatory
responses between different species which shared 
the same environment. We applied a partial-Spearman correlation based approach
to measure lower and upper tail-dependence
between two variables at their extreme lower and higher values, respectively. 
Stronger dependence in either tail of the joint distribution of 
two associated species' time-series from the same 
location leads to corresponding asymmetry in inter-specific relationships. 
With two long-term spatio-temporal datasets (\textit{Ceratium spp.} abundance data and 
aphids first flight data), we showed overall asymmetric tail-dependence is a common feature of 
inter-specific synchrony within a community, when we considered all combinations of species-pairs.
We investigated whether this asymmetry at species level was due to similar 
asymmetric tail-dependence of the species in response to their biotic and/ or abiotic drivers.
We considered the abundance of the generalist predator 
\textit{Calanus finmarchicus} and growing season temperature as two key drivers 
which shaped the phytoplankton community, whereas aphids 
first flight dates were influenced by average winter temperature. With a non-species-specific approach for \textit{Ceratium spp.} and and a species-specific apprroach to aphids, we found 
significant correlation between asymmetric tail-dependence of species-driver copulas
and species-species copulas, which explained the probable causal mechanism 
behind such commonly found asymmetric inter-specific response. 

\noindent \textbf{\textit{Keywords:}} tail dependence, copula, inter-species synchrony, aphids, plankton


<!--\noindent\makebox[\linewidth]{\rule{\columnwidth}{1pt}}
\normalsize-->

\newpage 

# Introduction\label{intro}
<!--Q1 : Does cross-species synchrony have any specific tail dependence, 
Q2: if yes, then what is the reason behind that?-->

<!--Motivation of the paper-->
Estimating synchronous or compensatory dynamics
among different species occupying a common geographical area
is a longstanding focus in ecology to predict the stability of 
aggregate community or ecosystem properties [@raimondo2004interspecific; @kent2007synchrony;
@loreau2008species; @gonzalez2009causes; @jochimsen2013compensatory]. In general,
past studies used correlation-based approaches or regression based analysis
to characterize temporal fluctuations of co-occuring species and thereby
overlooked the information of the dependence structure embedded in a multi-species 
distribution over time. Our recent study [@Ghosh_copula] showed 
the concept of the "copula" can be useful when quantifying "spatial synchrony" 
among metapopulations.  Studying spatial patterns of 
metapopulation-abundance through time and identifying 
the cause behind their correlated temporal 
flucuation (known as "spatial synchrony") has also been of longstanding
interest to ecologists [@lande1999; @liebhold2004; @walter2017]. The copula approach may give us more insight in explaining the 
causes and consequences of their synchronous response.   But in the case of inter-species 
synchrony, the use of the copula, to our knowledge, remains unexplored. Here, we will 
demonstrate the scope of using the statistical concept of the "copula" in studying
the synchronous or compensatory fluctuations of multiple co-occuring species over time.

<!--what is copula?-->
Copulas give a unique and 
complete representation of the dependence between variables, in the sense that
the joint distribution of two variables can be reconstructed 
completely from the copula and the marginal distributions [@sklar1959_theorem]. 
Copula approaches [@joe2014_dependence; @nelsen2006_copula] separate the information contained in a bivariate
random variable into two distinct parts: the information contained in the marginal distributions
(which says nothing about the dependence between the variables), 
and the remaining information (which is solely about the dependence between the
variables). To elaborate, a bivariate copula can be constructed from a set of two variables
$\{ x_i, y_i\}, i= 1,2,...,T$ after some ranking procedure is applied so that their marginal
distributions become uniform. If $\{ \bar{u_i}, \bar{v_i}\}$ are the corresponding ranks 
of $\{ x_i, y_i\}$, then $\{ u_i, v_i\} = \{ \bar{u_i}, \bar{v_i}\} / (T+1)$
reveals the associated dependence in the bivariate copula when plotted in a unit square.
Thus, measures of association which depend only on the copula and not on the marginal
distributions (e.g., Kendall's $\tau$ and Spearman's $\rho$) remain unchanged but usual
Pearson linear product-moment correlations of variables and of their copula transformed 
form are not the same. Correlation coefficients measure only the overall 
association of the samples and cannot tell us how their association varies across the distribution.
Through suitable choice from a wide varity of families and parameters, 
a good deal of control can be achieved in modelling the dependence structure of a bivariate
copula which shows over what parts of the distributions the 
variables are more strongly associated [@Ghosh_copula]. One aspect emphasized 
below is estimating the strength of the relationship between variables
in the tails of the distributions. 

<!--what is tail-dep.-->
Tail dependence is an association 
between extreme values of two variables in a copula. 
If smaller values of two positively associated variables 
are more strongly associated than the larger values as depicted in Fig. \ref{fig_intro}(A-C), the variables 
are said to have stronger 
lower-tail dependence than upper-tail dependence. Similarly, stronger upper tail 
dependence in copula results from two variables correlated strongly in their 
higher values (Fig. \ref{fig_intro}D,E).
In either case, those variables have asymmetric copula structure. Several
families of copulas are available with positive tail dependence exclusively in either
or both tail [@joe2014_dependence; @nelsen2006_copula], in addition to 
a copula from the 'Normal' family, having zero tail-dependence in 
both tails, and hence considered as a symmetric copula.
In the following we will discuss the relevance of the 
copula with its unique tail-dependence feature in modelling multi-species
ecological response.

<!--What causes asymmetric tail-dep ?------Leibigs law : limiting effects of environment, predators?-->
Asymmetric tail-dependence for the overall community is expected to be observed when most of its 
member species go synchronously rare or synchronously abundant. Net productivity for 
such an ecosystem could be constrained by some limiting factors (Leibig's law)
which include abiotic (temperature, windspeed, salinity 
or moisture) and biotic (predators, food-webs) interactions.
For example, extreme temperature has a profound effect on plant-productivity 
or plant pollination rate depending upon the species [@hatfield2015]. Copula structure with 
lower (or upper) tail-dependence of the dependence on such an abiotic or biotic variable
could cause corresponding asymmetric tail dependences in inter-species dependence structures. We will
elaborate this idea in the following example.

<!--earlier work on sp-driver relationships : aphids and plankton-->
Earlier work showed winter temperature had a profound effect on spatial 
synchrony between aphids [@sheppard2016]. Similarly, the plankton 
community in the North Sea was found to be affected by 
climatic variables like temperature and 
predatory zooplankton [@defriez2016climate; @sheppard2017; @sheppard2019].
Inspired by those findings, in this paper, we hypothesize possible biotic and/ or 
abiotic drivers could cause asymmetric tail-dependence in inter-specific synchrony for 
plankton or aphids. For example, consider a situation when harsh winter delayed first flight of aphids 
on a site, i. e., aphids first flight date was negatively correlated with winter temperature. If we 
made a copula with aphid first flight dates and negative winter temperature, then it could be 
either lower tail (Fig. \ref{fig_intro}B) or upper-tail dependent (Fig. \ref{fig_intro}D) depending on the
individual aphid species' response. Fig. \ref{fig_intro}B represents the idea that species $i$ came early when 
the site was warmer than usual (species first flight date facilitated by warmer temperature), whereas 
Fig. \ref{fig_intro}D represents the idea that species $i$ came late when the site was colder than usual (arrival of species $i$ at a site was limited by cold winter). 
If a majority of other aphids also showed similar trend with the temperature 
at a given site as depicted in Fig. \ref{fig_intro}B or D, then we hypothesize that we
would see the corresponding asymmetric tail-dependence between two species ($i \neq j$) first flight dates 
as depicted in Fig. \ref{fig_intro}C or E, respectively.

In this paper, we will introduce a "partial-Spearman correlation"-based approach to measure 
the "tail-dependence" of inter-species dependence structure.
We will analyze inter-species synchrony with two spatio-temporal datasets of 
two different taxa (plankton and aphids) to answer the following questions: 
(Q1) Do different species show synchronous behavior with asymmetric tail 
dependence (particularly lower or particularly upper) in their copula structure?
and (Q2) if they do show such asymmetric tail-dependence then what causes such asymmetry? 
We will also present two alternative approaches for investigating (Q2) for \textit{Ceratium spp.} and aphids. 

<!--introductory fig.-->
\begin{figure}[!h]
\begin{center}
\includegraphics[width=8 cm]{./Results/fig_intro_A.pdf}
\includegraphics[width=8 cm]{./Results/fig_intro_BCDE.pdf} 
\caption{(A) Pedagogical figure of a copula showing stronger dependence in lower tail ( considered 
to be the points lying on left of solid black or red lines) than in upper tail (considered to be the points lying 
on the right of solid black or blue lines). Asymmetric tail dependence in species-driver (negative 
temperature was considered as a driver for aphid species first flight date) copulas (B, D) caused similar 
asymmetric tail dependence in inter-species copulas (C, E).\label{fig_intro}}
\end{center}
\end{figure}


# Materials and Methods\label{M&M}

## Data \label{Data} 

<!--***DAN: I've written this assuming in the new Intro we will have mentioned
we will be working with a population and a phenology dataset, so make sure
to do that-->
Our population dataset comprised average annual 
abundance estimates for 15 locations (Fig. \ref{SM-fig_plankton_map})
in the North Sea and British seas for 4 species from the *Ceratium*
genus of dinoflagelates, and for the generalist consumer copepod species
*Calanus finmarchicus*, for the 56 years 1958 to 2013.
These data were a subset of a larger dataset covering 22 taxa 
and 26 locations, analyzed by @sheppard2017, @sheppard2019, and @Ghosh_copula.
The locations are $2^\circ$ by $2^\circ$ degree grid cells.
The data were originally obtained from the 
Continuous Plankton Recorder (CPR) dataset, 
now operated and maintained by 
the Marine Biological Association of the United Kingdom. 
Data preprocessing steps were same as used by @Ghosh_copula. 
*Ceratium* species were extracted in part because they
have an important role in red tides, and also because four 
species were available from the genus (Table \ref{tab_plankton_aphid_info}), 
and we wanted closely related 
species because they may compete with one another, and may 
be influenced in similar ways
by environmental variables. The 15 locations we used were 
selected from the 26 locations of the larger dataset 
(Fig. \ref{SM-fig_plankton_map}) as follows. 
First, to reduce the effects of sampling variation on statistical results,
we chose the subset of locations for which at least 36 years
<!--***DAN: why 36? Seems odd as stated-->
of data were available for all species.
Second, for a given location, we excluded *Ceratium* species 
that were undetected for more than 10$\%$ of sampled years at that location. 
Finally, we considered only those locations for which at least two 
*Ceratium* species remained. We also had average growing season 
sea surface temperature for each grid cell and year
[@sheppard2017; @sheppard2019]. Earlier analyses (e.g., @sheppard2019)
demonstrated that sea surface temperature and *C. finmarchicus* 
abundance are important covariates of phytoplankton dynamics 
in United Kingdom (UK) seas, 
though associations between temperature and phytoplankton are
probably due to relationships both these variables have with nutrient 
abundance in surface ocean layers. Sea surface 
temperature data preprocessing was the same as used by @sheppard2017.

Our phenological dataset comprised annual first flight dates
for 20 aphid species (Table \ref{tab_plankton_aphid_info})
from 10 locations across the UK (Fig. \ref{SM-fig_aphid_map}),
spanning the 35 years 1976 to 2010. These data were a subset of a larger
dataset covering 11 locations, analyzed previously by @sheppard2016
and @Ghosh_copula. The data were originally obtained from the 
Rothamsted Insect Survey suction-trap dataset 
[@harrington2014; @bell2015]. Data preprocessing 
was the same as that of [@sheppard2016]. 
Locations were screened, leading to the removal of one of the original
11 sampling locations, by requiring at least 30 years of data be 
available for all species, again to reduce sampling variation of
statistics. We also had time series of winter average 
temperature for each location and year. The winter temerature for 
year $t$ was the average of December of year $t-1$ to March of year $t$.
Earlier analyses have demonstrated the importance of winter temperature
for aphid first flight date (e.g., @sheppard2016).

## Methods\label{Methods}

To begin with, we considered $T$ years long time series were available for $s$ number of species along with 
$d$ abiotic and/ or biotic drivers (i. e. temperature or predator abundance) for any $n^{th}$ site.
For each selected location we constructed a bivariate copula made of time series of either
two species or with a species and time series of the driver
in the following way: given a bivariate dataset from $n^{th}$ site, $(x_t^n,y_t^n)$ for $t=1,...,T$, 
first, we produced ranks $(\tilde{u}_t^n,\tilde{v}_t^n)$ where $\tilde{u}_t^n$ is the rank of $x_t^n$ in the set 
$\{x_t^n:t=1,...,T\}$ and $\tilde{v}_t^n$ is the rank of $y_t^n$ in the set $\{y_t^n:t=1,...,T\}$. 
we set $u_t^n=\tilde{u}_t^n/(T+1)$ and $v_t^n=\tilde{v}_t^n/(T+1)$; subsequent analysis used these 
*normalized ranks* $u_t^n \in [0,1]$ and $v_t^n \in [0,1]$. Rank was $1$ for the smallest element in each set. 
Second, we did a test of the independence of the $u_t^n$ and $v_t^n$ 
(implemented in `BiCopIndTest` in the `VineCopula` package). 
If independence could be rejected ($0.05$ significance level), and $(u_t^n, v_t^n)$
were postively correlated then we proceed to measure dependence. For a significantly negative 
association, we started with $(x_t^n, - y_t^n)$ so that $(u_t^n, v_t^n)$ remained positively correlated.
We computed the partial Spearman correlation statistics $\cor_{l_b,u_b}$ as introduced in [@Ghosh_copula]
as dependence measures for a positively correlated bivariate copula. 

Given lower and upper boundaries by two parallel lines ($u_t^n+v_t^n = 2l_b$, $u_t^n+v_t^n = 2u_b$ such that $0 \leq l_b < u_b \leq 1$) 
which scans the region of interest of the copula within a unit square box, we here
redefine the statistics we computed within the bounds; 
\begin{equation}\label{eq.Cor}
   \cor_{l_b,u_b}^n(u,v) = \frac{\sum 
   (u_t^n-\mean(u)) (v_t^n-\mean(v))}{(T-1)\sqrt{\var(u)\var(v)}}.
\end{equation}
Here means and sample variances are computed using all $T$ data points for the $n^{th}$ location, but the
sum is over only the indices $t$ for which $u_t^n+v_t^n > 2l_b$ and $u_t^n+v_t^n < 2u_b$. 
The sum of $\cor_{0,1/2}^n(u,v)$ and $\cor_{1/2,1}^n(u,v)$ (or some other choice of 
$\cor_{l_{b_k},u_{b_k}}^n(u,v)$ for bounds $l_{b_k},u_{b_k}$ that partition the 
interval $(0,1)$) equals the standard Spearman correlation. This is not true
if there is any point lying exactly on the bounds, as those points then do not contribute 
to the partial Sperman correlation (Eq. \ref{eq.Cor}), but are included to estimate standard
Spearman correlation.

<!--## Methods to answer (Q1)-->
Consider, a bivariate copula was made with *normalized ranks* $(u, v)$ of any two time series
(e.g. see Fig. \ref{fig_intro}A) of species pair $(i, j)$ taken from $n^{th}$ site. For simplicity, 
let us assume that the corresponding variables $(u, v)$ showed significant positive 
correlation, i. e., points are scattered along the 
diagonal (dotted line in Fig. \ref{fig_intro}A) of the unit square box. We divided the diagonal
line by $p$ equispaced partitions so that dependence between $(u, v)$ could be measured by parts. 
To estimate lower and upper tail dependence specifically, Eq. \ref{eq.Cor} was 
applied for the points lying in the bottommost and the topmost triangular partitions, respectively. 
Given $0 \leq b (= 1/p) \leq 0.5$, we used the shorthand notation for lower tail 
dependence as $C^n_L(i, j) = \cor_{l_b,u_b}^n(u,v)$ with $(l_b,u_b)=(0,b)$
and for the upper tail dependence as $C^n_U(i, j) = \cor_{l_b,u_b}^n(u,v)$ with $(l_b,u_b)=(1-b,1)$,
respectively. We considered $b = 1/3$ for plankton data; $C^n_L(i, j)$
was computed for the points lying on the left side of the red line whereas $C^n_U(i, j)$ was computed 
for the points lying on the right side of the blue line in Fig. \ref{fig_intro}A. Due to fewer data
points of aphid first flight data, we examined two equal halves ($b = 1/2$) of the unit 
square where $C^n_L(i, j)$ and $C^n_U(i, j)$ were measured for the points scattered on the left and right side of 
the solid black line (Fig. \ref{fig_intro}A), respectively. 

Higher partial Spearman 
correlation in lower tail, i.e., when $C^n_{L-U}(i, j) = C_L^n(i, j)  - C_U^n(i, j)$ is positive, 
indicates asymmetry in tail-dependence of a copula and to be specific 
stronger lower tail dependence than upper. Similarly, negative value of 
$C^n_{L-U}(i, j)$ would indicate stronger upper tail 
dependence than lower in an asymmetric copula. 
For the $n^{th}$ site, we estimated $C^n_{L-U}(i, j)$ for all 
pairwise combination of $(i \neq j)$ to exclude self-comparison, and from now on 
it is implicit that whenever we would mention estimates for any species pair $(i,j)$, they
are coming from two different species, i. e. $i \neq j$. 
Considering only positive correlation ($0.05$ significance level) between species, 
we counted number of lower-tail dominant ($N_L$) and upper-tail dominant ($N_U$) 
species pair for which $C^n_{L-U}(i, j)>0$ and $C^n_{L-U}(i, j)<0$, respectively. 
We defined estimates of lower and upper tail
asymmetry on species level for $n^{th}$ site as
$A_S^{n+} = \sum\limits_{i=1}^s\sum\limits_{j=1}^s C^n_{L-U}(i, j)$ where 
the sum is over positive values of C only( i.e. for $C^n_{L-U}(i, j) >0$) 
and $A_S^{n-} = \sum\limits_{i=1}^s\sum\limits_{j=1}^s C^n_{L-U}(i, j)$ where 
the sum is over negative values of C only( i.e. for $C^n_{L-U}(i, j) <0$), 
respectively. These sums were considered for positively correlated species pair ($i \neq j$). 
Total species-asymmetry $A_S^{n} = A_S^{n+} + A_S^{n-}$ was assessed for 
each selected site which could
answer (Q1); if $A_S^{n} \neq 0$ then it would indicate asymmetry in 
overall tail-dependence. But to get more precise answer, whether the asymmetric
tail dependence was stronger in the lower values or upper, the proportion 
of lower and upper tail dominance
in overall asymmetry at each site were measured
by $f_L = \frac{A_S^{n+}}{A_S^{n+} + |A_S^{n-}|}$ and
$f_U = \frac{|A_S^{n-}|}{A_S^{n+} + |A_S^{n-}|}$, respectively.
These values of $f_L$ and $f_U$ from each site were used to answer (Q1) that different 
species could show synchronous behavior with specific tail-dependent asymmetry. Note 
that $A_S^{n}$ is just the absolute difference in tail dependence, 
whereas $f$'s are the imbalance in tail dependence relative to the total amount 
of tail dependence found in the inter-species copulas. 

<!--## Methods to answer (Q2)-->

To answer (Q2), our approach was to investigate the causal relationship between 
inter-species tail dependence and tail-dependence between
species with biotic and/ or abiotic drivers. We used two slightly different estimators to answer (Q2) 
for our two datasets. First, we estimated lower minus upper tail dependence
$C_{L-U}^n(i, k); i = 1,\dots ,s$ and $k = 1,\dots ,d$ 
for the copulas made with species and drivers' time series from any $n^{th}$ site
as we did with copulas for any two species pair combination. If time series of $i^{th}$ species 
at $n^{th}$ site (say, $x_i^n$) were negatively correlated with time 
series of $k^{th}$ drivers at that site (say, $y_k^n$), then we made a copula with $(x_i^n, -y_k^n)$ 
and subsequent asymmetry of tail-dependence was measured using that copula. For positively correlated 
species and drivers through time, we did not reverse the time series $y_k^n$. We measured total asymmetry 
of driver dependencies as $A_D^n =\sum\limits_{i=1}^s\sum\limits_{k=1}^d C^n_{L-U}(i, k)$ and tested if there was
any significant correlation between $A_D^n$ and $A_S^n$ considered for all selected sites. This 
approach was better when we examined behaviour of fewer but similar species, like the four \textit{Ceratium spp.} 
of dinoflagellate class. Our second approach was more suitable when 
there were several species coming from different genus, so expected to show more variation
in inter-species response, as we will see with aphid (20 species) first flight data. 
For a species-specific approach, we examined correlation between response for 
$i^{th}$ individual species with all the other species ($\alpha_S^n(i)$) and with its drivers ($\alpha_D^n(i)$). 
We measured those two quantities as $\alpha_S^n(i) = \sum\limits_{j=1}^{s} C^n_{L-U}(i, j)$ for $(i \neq j)$ and 
$\alpha_D^n(i) = \sum\limits_{k=1}^{d} C^n_{L-U}(i, k)$, respectively, for a given $i^{th}$ species. Significant correlation 
between $A_D^n$ and $A_S^n$ (for plankton) or between $\alpha_D^n(i)$ and $\alpha_S^n(i)$ (for aphids)
would establish our hypothesis that asymmetric tail dependence in inter-specific response was caused by similar
asymmetric tail-dependence in species-driver copulas.


# Results\label{Results}

<!--Results for Q1-->
We found major asymmetric tail-dependence when we considered all pairwise combinations of
species time-series from a given location. Summarized results for all selected locations
showing asymmetry in either tail for \textit{Ceratium spp.} 
is depicted in Fig. \ref{fig_CorlmCoru_plankton_map_loc12_26}(A), where we plot $f_L$ and
$f_U$ (see \nameref{Methods}) for each of the selected sites 
(except site 3 as there were no significant dependence between species abundances). Site
codes in the map are colored red if sites showed a
stronger lower tail dependence contribution (i.e. $f_L > f_U$ indicating synchronous rare 
occurrence of \textit{Ceratium} species). Similarly, locations where \textit{Ceratium spp.} were synchronously 
abundant (site codes in blue color of Fig. \ref{fig_CorlmCoru_plankton_map_loc12_26}A), had 
more upper tail dependent contribution ($f_U > f_L$). The partial Spearman correlation-based lower minus upper 
tail dependence matrix ($C_{L-U}^n$) for sites $n=12$ (Fig. \ref{fig_CorlmCoru_plankton_map_loc12_26}B) and $n=26$ (Fig. \ref{fig_CorlmCoru_plankton_map_loc12_26}C) are shown as two example cases (for 
other locations see Fig. \ref{SM-fig_CorlmCoru_plankton_all_loc}). 
Whereas Location 12 showed dominantly lower tail-dependent interspecific synchrony with 
all 12 pairwise copula having
lower tail dependence ($N_L = 12, N_U = 0$), Location 26 showed 
stronger upper tail dependence ($N_L = 2, N_U = 4$). 

We got similar findings for aphid firsflight data (Fig. \ref{fig_CorlmCoru_ff_map_loc2_5}). Proportion of lower 
($f_L$) and upper ($f_U$) tail dependence estimates in overall tail-asymmetry was summarized for 10 selected 
sampling sites in Fig. \ref{fig_CorlmCoru_ff_map_loc2_5}(A). $8$ out of $10$ sites were dominantly upper 
tail dependent in $C_{L-U}^n$ (site codes in blue color of Fig. \ref{fig_CorlmCoru_ff_map_loc2_5}A),
indicating overall synchronous late arrival of 20 aphids at those $8$ locations.
Two representative cases for major lower 
(where $N_L > N_U$ for site $n = 2$) and upper (where $N_U > N_L$ for site $n = 5$) tail 
dependence matrix $C_{L-U}^n$ are pictured in 
Fig. \ref{fig_CorlmCoru_ff_map_loc2_5}(B) and (C), respectively. Major asymmetric tail-dependence 
observed with one set of population data (plankton)
and one set of phenological data (aphids first flight) answered (Q1), indicating that inter-specific 
synchrony is not well described by standard correlation metrics, as these 
obscure the fact that species may be simultaneously rare, or simultaneously 
common, with the same resultant correlation coefficient.

<!--plankton plots : Q1-->
\begin{figure}[!h]
\begin{center}
\textbf{ (A)} \\
\includegraphics[width=8 cm]{./Results/plankton_results/npa_stat_results/Corstat_LmU_values_on_map_sp_only.pdf} \\
\vspace{1 cm}
\textbf{ \hspace{1 cm} (B) \hspace{7 cm} (C)} \\
\includegraphics[width=8 cm]{./Results/plankton_results/npa_stat_results/loc12/loc12_Corl-Coru.pdf}
\includegraphics[width=8 cm]{./Results/plankton_results/npa_stat_results/loc26/loc26_Corl-Coru.pdf}
\caption{$(A)$ Proportion of tail dominant contribution ($f_L$ for lower tail and $f_U$ for upper tail 
showing on a color scale between 0 to 1) in overall asymmetry, plotted for each 
selected locations among 26 sites (see Fig. \ref{SM-fig_plankton_map}) separately for sp-sp interaction matrix,
summarizes the overall asymmetry in tail-dependence for all sampling sites. Sites with lower tail dominance
have site code in red color, whereas upper tail dominant sites have blue site code. Site 3 has independent 
relationship between species. Lower tail - upper tail dependence 
matrix ($C_{L-U}^n$ for location n = 12 and n = 26) with Ceratium abundances 
are showin in $(B)$ and $(C)$, respectively. For other locations see Fig. \ref{SM-fig_CorlmCoru_plankton_all_loc}.
The last 2 rows and columns are for the estimates from interaction between \textit{Ceratium spp.} and  
drivers (\textit{Calanus finmarchicus}, growing season temperature).
$N_L$ and $N_U$ are the count of cells with positive and 
negative values for positively correlated species pair. $N_L > N_U$ in $(B)$ 
indicates major lower tail dependence in sp-sp interaction matrix. Similarly, $N_U > N_L$ in $(C)$ indicates more upper
tail dependence. Yellow cells indicate independent relationship. Cells with a green dot indicates associated 
variables were negatively correlated initially and hence we reversed the variables in column so that the copula had positive association.\label{fig_CorlmCoru_plankton_map_loc12_26}}
\end{center}
\end{figure}

<!--aphid plots : Q1-->
\begin{figure}[!h]
\begin{center}
\textbf{ (A)} \\
\includegraphics[width=8 cm]{./Results/aphid_results/ff_npa_stat_results/Corstat_LmU_values_on_map_sp_only.pdf} \\
\vspace{1 cm}
\textbf{ (B) \hspace{7 cm} (C)} \\
\includegraphics[width=8 cm]{./Results/aphid_results/ff_npa_stat_results/loc2/loc2_Corl-Coru.pdf}
\includegraphics[width=8 cm]{./Results/aphid_results/ff_npa_stat_results/loc5/loc5_Corl-Coru.pdf}
\caption{$(A)$ Proportion of tail dominant contribution ($f_L$ for lower tail and $f_U$ for upper tail 
showing on a color scale between 0 to 1) in overall asymmetry for each of the
selected 10 locations (see Fig. \ref{SM-fig_aphid_map}) summarizes the overall 
asymmetry in tail-dependence for all sampling sites. Sites with lower tail dominance
have site code in red color, whereas upper tail dominant sites have blue site code. 
Lower tail - upper tail dependence matrix 
($C_{L-U}^n$) with first flight data of 20 aphid species are shown in (B) for location n = 2 and
in (C) for location n = 5, for other locations see Fig. \ref{SM-fig_CorlmCoru_ff_all_loc}. 
The last row and column indicates estimates from the interaction between each 
aphid species and winter average temperature (which was supposed to be the driver of the species' synchrony),
details were discussed in \nameref{Results}. $N_L$ and $N_U$ are the count of positive and 
negative cells for 20$\times$ 20 matrix; $N_L > N_U$ in $(B)$ 
indicating major lower tail dependence in the sp-sp interaction matrix. Similarly, $N_U > N_L$ in $(C)$ indicates more upper
tail dependence. Yellow cells indicate independent relationship. Cells with a green dot indicate the associated 
variables were negatively correlated initially and hence we reversed the variables in column so that the copula had positive association.\label{fig_CorlmCoru_ff_map_loc2_5}}
\end{center}
\end{figure}


<!--Results for Q2-->
To explain asymmetric tail-dependence between 
\textit{Ceratium spp.} ($s = 4$), we considered abundance of predator C. fin 
and growing season temperature as two key drivers ($d = 2$) for inter-specific synchrony. 
We observed species synchronous responses towards biotic and/ or abiotic stress
which transmitted similar asymmetric tail-dependence from drivers level ($A_D^n$ or $\alpha_D^n$)
to species level ($A_S^n$ or $\alpha_S^n$). 
We did a two-tailed correlation test between $A_S^n$ and $A_D^n$ for all selected location $n$ 
excluding $n = 3$ (as site 3 was independent). We got significant 
positive Pearson correlation ($0.699$)<!--caution : not automated link--> with p-value $<<0.025$, 
which confirmed our hypothesis for (Q2) that tail-asymmetry translated from driver to species level 
(Fig. \ref{fig_plankton_scatter}). In other words, if all \textit{Ceratium} species were 
particularly correlated in their lower tails with their drivers, they were
particularly correlated in their lower tails with each other, and vice versa. 
For aphids, we considered winter average temperature as 
the main driver $(d = 1)$ for their synchronous first flight date at a given location, $n$. 
We tried a similar approach as of \textit{Ceratium spp.} to explain the causal mechanism for 
asymmetric tail-dependence at species level. Since aphids were 20 different sp. which 
varied widely in their inter-specific response and were also not expected 
to have direct interactions as of the \textit{Ceratium} community,
$A_S^n$ and $A_D^n$ could not illuminate the causal relationship 
(Fig. \ref{SM-fig_aphid_scatter}, non-significant Pearson correlation with $p = 0.0678$). 
In an alternative approach, for each of the selected 
10 locations, we computed the Kendall's correlation coefficient $(K)$ between
$\alpha_S^n(i)$ and $\alpha_D^n(i)$, where
$i = 1, 2, \dots ,20$ represented the species index. We found for the $i^{th}$ aphid species, the 
tail dependence of species-temperature copula results in similar tail dependence in inter-species copula 
for 7 out of 10 sites (based on p-value with $0.05$ significance level, Fig. \ref{fig_aphid_multipanel}),
which answered the probable causal mechanism behind inter-species synchrony (Q2). In other words, 
if an aphid species was particularly correlated in its lower tail with the driver, it 
was particularly correlated in its lower tail with the other aphid species.


<!--plankton scatter plot : Q2-->
\begin{figure}[!h]
\begin{center}
\includegraphics[width=10 cm]{./Results/plankton_results/npa_stat_results/Corstat_scatter_LmU_values.pdf} 
\caption{Siginificant positive Pearson correlation (p value based on two-tailed test) between total 
asymmetry on species level $A_S^n$ and on driver level $A_D^n$ represents causal relationship between 
tail-dependence of inter-species synchrony with its drivers (C. fin. and growing season temperature) for 
\textit{Ceratium spp.}, numbers in the plot represent the side code $n$.\label{fig_plankton_scatter}}
\end{center}
\end{figure}


<!--aphid multipanel plot : Q2-->
\begin{figure}[!h]
\begin{center}
\includegraphics[width=16 cm]{./Results/aphid_results/ff_npa_stat_results/Corstat_LmU_avg_sp_temp_multipanel_plot.pdf} 
\caption{For 7 out of 10 sites, the Kendall correlation between $\alpha_S^n(i)$ and $\alpha_D^n(i) ; i = 1, 2, \dots, 20$, 
is significant (p $< 0.05$, one tailed test). This indicates asymmetric tail-dependence between species-winter
average temperature is the reason for similar tail-dependence between the $i^{th}$ species
and the other species.\label{fig_aphid_multipanel}}
\end{center}
\end{figure}


# Discussion\label{Discussion}

<!--summary results-->
We found  substantial inter-specific synchrony with asymmetric tail-dependence between different 
species sharing the same location through time.  With two long-term spatio-temporal 
datasets from two different taxa, we showed partial-Spearman correlation 
estimates at extreme tails of copulas could be used as a simple tool to study dependence 
interactions between species. We also analyzed the probable causal mechanism of observed asymmetric 
tail-dependence. We hypothesized asymmetric interactions (biotic/ abiotic) of species with its 
environmental drivers which transmitted similar tail-dependence through the inter-species level. We 
verified our hypothesis with two alternative approaches for plankton and aphids, respectively. We think 
our approaches could be useful in investigating inter-species dependence structures for more
complex systems like foodwebs with multiple trophic interactions.

<!--why aphids showing more upper tail dep. like in fig1e, rather than 1c?-->
We found aphids were more common with synchronous late arrival (upper tail dependence;
$N_U > N_L$) at 8 out of 10 sites. This was attributed to the fact that aphid first flight dates
were limited by cold winter effects (Fig. \ref{fig_intro}D), causing a dependence structure like Fig. \ref{fig_intro}E 
more frequently than Fig. \ref{fig_intro}C. We believe this is explained by 
the particular sensitivity of overwintering aphids to frost conditions
(killing non-winged morphs) delaying the population reaching the winged-morph stage, and first flight.

<!--Why consider only postively correlated cells ?-->
We considered only positively correlated species pair in explaining the causal 
relationship of inter-specific synchrony with its drivers. All aphids showed positive 
correlation with each other at all selected locations 
(Figs. \ref{fig_CorlmCoru_ff_map_loc2_5}, \ref{SM-fig_CorlmCoru_ff_all_loc}). 
For \textit{Ceratium} species, species $4$ (\textit{Ceratium macroceros}) was 
found to have no significant correlation with either 
driver at locations $n = 18$ and $n = 21$, unlike the other species which were typically found to be 
negatively correlated with the drivers at locations where data was available 
(Fig. \ref{SM-fig_CorlmCoru_plankton_all_loc}).  Thus we do not expect 
these drivers to influence the behaviour of species $4$ in either the upper or lower tail of its 
distribution, and in fact at location $18$ species $4$ was found to be negatively correlated 
with another \textit{Ceratium} species (sp = 2: \textit{Ceratium furca}), 
unlike all other inter-species correlations which were found to be positive 
due to their common relationship with the drivers. The tail dependence $C_{L-U}^{n}(2,4)$ and
$C_{L-U}^{n}(4,2)$ associated 
with this negative relationship were not included in the calculation 
of asymmetry estimates ($A_S^{n+}$, $A_S^{n-}$, $A_S^{n}$) at location $n=18$, as described in methods, 
and our hypothesis that the inter-species tail dependence measures would match driver-species
tail dependence measures cannot be applied to this species.

<!--what extra info do you get by monitoring tail dep. for plankton?-->
Monitoring tail dependence (a measure of "synchrony") could reveal interesting information about 
an ecosystem. We expect our resuts to generalize to other plankton systems subject to limiting factors.
In most freshwater lakes algal-productivity is limited by the availability 
of inorganic phosphorus, represented by lower tail-dependence (stronger association
between smaller values) in a copula made of plankton abundance and phosphorous level.
But excessive fertilizers (through sewage or agricultural runoff) beyond a threshold 
can catalyze plankton-growth. Phytoplankton bloom, an
ecosystem-level perturbation, occurs when compensatory dynamics between perturbation-sensitive
phytoplankton and perturbation-tolerant taxa become weak and so dramatic changes occur in the total
biomass on aggregate level. As phytoplankton communities are diverse in response to change
in the nutrient level in a lake, monitoring their individual dynamics through copula approaches 
could help to better understand the phytoplankton-resilience on the community level and 
even could be used as an "early warning" before the actual bloom occurs.

<!--plankton regime shift (CALFIN-CALHEL) depending on temperature or salinity?-->







<!--Table with species info -->
```{r tab_plankton_aphid_info, echo=F, results='asis',message=F}
library(tinytex)
library(tibble)
library(kableExtra)
library(dplyr)

#aphid_info_org <- tibble(c0=c(1:20),
#                     c1=c("Apple grass aphid","Bird cherry oat aphid","Black bean aphid","Blackberry cereal aphid",
#                       "Blackcurrant sowthistle aphid",
#                      "Corn leaf aphid","Currant lettuce aphid","Damson hop aphid","Grain aphid","Green spruce aphid",
#                      "Leaf-curling plum aphid","Mealy cabbage aphid","Mealy plum aphid","Pea aphid","Peach potato aphid",
#                      "Potato aphid","Rose grain aphid","Shallot aphid","Sycamore aphid","Willow carrot aphid"),
#                    c2=c("Rhopalosiphum insertum", "Rhopalosiphum padi", "Aphis fabae", "Sitobion fragariae", "Hyperomyzus lactucae",
#                      "Rhopalosiphum maidis", "Nasonovia ribisnigri","Phorodon humuli","Sitobion avenae","Elatobium abietinum",
#                       "Brachycaudus helichrysi","Brevicoryne brassicae","Hyalopterus pruni","Acyrthosiphon pisum","Myzus persicae",
#                       "Macrosiphum euphorbiae","Metopolophium dirhodum","Myzus ascalonicus","Drepanosiphum platanoidis","Cavariella #aegopodii")
#)

plankton_aphid_info <- tibble(c0=c(1:4,1:20),
                     c2=c("Ceratium fusus","Ceratium furca","Ceratium tripos","Ceratium macroceros",
                          "Rhopalosiphum insertum", "Rhopalosiphum padi", "Aphis fabae", "Sitobion fragariae",
                          "Hyperomyzus lactucae", "Rhopalosiphum maidis", "Nasonovia ribisnigri","Phorodon humuli",
                          "Sitobion avenae","Elatobium abietinum", "Brachycaudus helichrysi","Brevicoryne brassicae",
                          "Hyalopterus pruni","Acyrthosiphon pisum","Myzus persicae", "Macrosiphum euphorbiae",
                          "Metopolophium dirhodum","Myzus ascalonicus","Drepanosiphum platanoidis","Cavariella aegopodii"                                           ))
knitr::kable(plankton_aphid_info, "latex", booktabs = T, linesep = "",align="c",
      caption = "Species names of 4 plankton and 20 aphids for which data were used \\label{tab_plankton_aphid_info}",
      col.names = NULL)%>%
      group_rows("Plankton", 1,4) %>%
      group_rows("Aphids", 5,24) %>%
      column_spec(column = 2,italic=T)%>%add_header_above(header=c("Species id" = 1, "Latin binomial" = 1))
```













\clearpage

# Literature cited

\setlength{\parindent}{-0.2in}
\setlength{\leftskip}{0.2in}
\setlength{\parskip}{1pt}
\noindent
